- benchmarking #Polars #Parquet
	- ### Partition by with 100_000_000 records
		- ```python
		  dfp_period = dfp.with_columns(pl.col('datetime').dt.strftime('%Y_%m_%d').alias('period'))
		  dfp_partition = dfp_period.partition_by("period", as_dict=True)
		  ```
		- day
			- adding period column: 23s
			- full partition: 24sec
			- partition with dt.year, dt.month, dt.day: 1.7s
		- month
			- adding period column: 16s
			- full parition 18s
			- ```python
			  dfp_period = dfp.with_columns([pl.col('datetime').dt.year().alias('year'), pl.col('datetime').dt.month().alias('month')])
			  ```
			- partition with dt.year, dt.month: 1.6s
			- #### More optimization: ==include_key=False==
				- ```python
				  dfp_period = dfp.with_columns([pl.col('datetime').dt.year().alias('year'), 
				                                 pl.col('datetime').dt.month().alias('month')])
				  dfp_partition = dfp_period.partition_by("year", "month", as_dict=True, include_key=False)
				  ```
				-
		- year
			- adding period column: 10s
			- full partition: 11s
			- ```python
			  dfp_period = dfp.with_columns(pl.col('datetime').dt.year().alias('period'))
			  ```
			- partition with dt.year: 1.6s
		- ## Conclusion:
			- Partition by year, month
				- ```python
				  dfp_period = dfp.with_columns([pl.col('datetime').dt.year().alias('year'), 
				                                 pl.col('datetime').dt.month().alias('month')])
				  dfp_partition = dfp_period.partition_by("year", "month", as_dict=True, include_key=False)
				  ```
		- ### Optimized Write 100_000_000 records
			- polars write_parquet: 13s (improvement with 12s). [[Parquet]] files can't be read in [[dev/dev tools/pycharm/PyCharm]]
				- ```python
				  dfp2 = dfp.with_columns(pl.col("datetime").dt.cast_time_unit("ms"))
				  dfp_period = dfp.with_columns([pl.col('datetime').dt.year().alias('year'), 
				                                 pl.col('datetime').dt.month().alias('month')])
				  dfp_partition = dfp_period.partition_by("year", "month", as_dict=True, include_key=False)
				  for name, dfpx in dfp_partition.items():
				      year, month = name
				      filename = f"C:/Users/lemton00/OneDrive - Sibelco/DEV/DATA/timeseries/arrow/{year}_{month:02d}.parquet"
				      dfpx.write_parquet(filename)
				  ```
			-
			-
			-