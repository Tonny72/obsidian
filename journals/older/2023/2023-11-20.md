- #Polars
	- calculate linear regression of irregular [[time series]] dataframe
- ```Python
  print("hello")	
  ```
- ```python
  def resample(dataframe, datetime_column:str, value_column: str, interval: str, alias: str):
      return ((((df.join(
      # make datetime range
      pl.datetime_range(
      start=df.select(pl.col("datetime").min()).item(),
      end=df.select(pl.col("datetime").max()).item(),
      interval=interval,
      eager=True,
      ).alias("datetime").to_frame(), on="datetime", how="outer")
                 # dts_value column = datetime_column in seconds
                 .with_columns((pl.col(datetime_column).dt.epoch("ms")/1000.0).alias("dts_value")))
                #  dts column is null when value is null
                .with_columns(pl.when(pl.col(value_column).is_null())
                              .then(pl.lit(None))
                              .otherwise(pl.col("dts_value")).alias("dts")))
               # find previous en next dts and value
               .with_columns(pl.col("dts").fill_null(strategy="forward").alias("prev_dts"),
                 pl.col("dts").fill_null(strategy="backward").alias("next_dts"),
                 pl.col("value").fill_null(strategy="forward").alias("prev_value"),
                 pl.col("value").fill_null(strategy="backward").alias("next_value")))
              # calculate lineair regression
              .with_columns(pl.when(pl.col(value_column).is_not_null()).then(pl.col(value_column))
                 .otherwise( (pl.col("next_value")-pl.col("prev_value")).alias("diff_value") / (pl.col("next_dts")-pl.col("prev_dts")) * (pl.col("dts_value")- pl.col("prev_dts")) + pl.col("prev_value")).alias(alias))).drop("dts_value", "dts", "prev_dts", "next_dts", "prev_value", "next_value")
      
  dfx = resample(df, "datetime", "value", "15s", "value")
  ```